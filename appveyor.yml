version: "{build}-{branch}"

branches:
  except:
    - gh-pages

build: off

init:
  - ps: (get-psprovider 'FileSystem').Home = $(pwd)
  - ps: Install-PackageProvider Nuget -Force
  - ps: Install-Module -Name Pester -Repository PSGallery -Force
  - ps: Install-Module -Name PSScriptAnalyzer -Repository PSGallery -Force
  - pwsh: (get-psprovider 'FileSystem').Home = $(pwd)
  - pwsh: Install-Module -Name Pester -Repository PSGallery -Force
  - pwsh: Install-Module -Name PSScriptAnalyzer -Repository PSGallery -Force

test_script:
  - ps: ./appveyor/test_script.ps1; if($env:failedcount -gt 0) { exit $env:failedcount }
  - pwsh: ./appveyor/test_script.ps1; if($env:failedcount -gt 0) { exit $env:failedcount }

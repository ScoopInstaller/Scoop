{
    "##": "Proof of concept to install rsync in it's own usr/bin directory (~/scoop/apps/rsync/current/usr/bin)",
    "##": "By installing it along with PortableGit",
    "##": "props to https://github.com/rivy/scoop-bucket/blob/master/rsync.json",
    "homepage": "https://git-for-windows.github.io/",
    "license": "GPL-2.0-only",
    "version": "3.1.3",
    "##": "ref: <https://blog.tiger-workshop.com/add-rsync-to-git-bash-for-windows> @@ <https://archive.is/WJCrw>",
    "##": "ref: <https://serverfault.com/a/872557/24273> @@ <https://archive.is/rAfUl#20%>",
    "architecture": {
        "64bit": {
            "url": [
                "http://repo.msys2.org/msys/x86_64/rsync-3.1.3-1-x86_64.pkg.tar.xz",
                "https://github.com/git-for-windows/git/releases/download/v2.18.0.windows.1/PortableGit-2.18.0-64-bit.7z.exe#/dl.7z"
            ],
            "hash": [
                "c397eba60b48227277c8da49f7fabbe9e6af20ee1e68b402e296e672b7a52a6a",
                "cd84a13b6c7aac0e924cb4db2476e2f4379aab4b8e60246992a6c5eebeac360c"
            ]
        },
        "32bit": {
            "url": [
                "http://repo.msys2.org/msys/i686/rsync-3.1.3-1-i686.pkg.tar.xz",
                "https://github.com/git-for-windows/git/releases/download/v2.18.0.windows.1/PortableGit-2.18.0-32-bit.7z.exe#/dl.7z"
            ],
            "hash": [
                "e7a7e21a8c894eba97365265beb0e90a42d31109514f74a0a28d22299c856cbf",
                "28e68a781a78009913fef3d6c1074a6c91b05e4010bfd9efaff7b8398c87e017"
            ]
        }
    },
    "##": "ref: <https://zsoltfabok.com/blog/2017/03/windows-rsync> @@ <https://archive.is/D8i3C>",
    "bin": "usr/bin/rsync.exe",
    "notes": [
        "NOTE: local paths with a leading '/' or internal ':' must instead be in Cygwin cygpath format (eg, '/c/...')"
    ],
    "post_install": [
        "If ($global) {$target='Machine'} Else {$target='User'}",
        "$ssh_path=\"$(scoop which ssh)\"",
        "$ssh_path=\"$(resolve-path $ssh_path)\"",
        "If (Test-Path $ssh_path) {",
        "   Write-Host -f darkgray \"Setting %RSYNC_RSH% to $ssh_path for the $target\"",
        "   [Environment]::SetEnvironmentVariable('RSYNC_RSH', $ssh_path, $target)",
        "   Write-Host -f darkgray \"Setting %RSYNC_SSH% to $ssh_path for the $target\"",
        "   [Environment]::SetEnvironmentVariable('RSYNC_SSH', $ssh_path, $target)",
        "   Write-Host -f darkyellow \"Please restart your command shell for these changes to take effect\"",
        "} else {",
        "   Write-Host -f darkgray \"%RSYNC_RSH% and %RSYNC_SSH% have not been set as ssh.exe was not found in the path\"",
        "}"
    ],
    "uninstaller": {
        "script": [
            "If ($global) {$target='Machine'} Else {$target='User'}",
            "If (Test-Path \"$(appdir git $global)/current/usr/bin/rsync.exe\") {",
            "   Write-Host -f darkgray \"Deleting '$(appdir git $global)/current/usr/bin/rsync.exe'\"",
            "   Remove-Item -Path \"$(appdir git $global)/current/usr/bin/rsync.exe\" -Force",
            "}",
            "If ([Environment]::GetEnvironmentVariable('RSYNC_RSH', $target)) {",
            "   Write-Host -f darkgray \"Removing %RSYNC_RSH% for the $target\"",
            "   [Environment]::SetEnvironmentVariable('RSYNC_RSH', $null, $target)",
            "}",
            "If ([Environment]::GetEnvironmentVariable('RSYNC_SSH', $target)) {",
            "   Write-Host -f darkgray \"Removing %RSYNC_SSH% for the $target\"",
            "   [Environment]::SetEnvironmentVariable('RSYNC_SSH', $null, $target)",
            "}",
            "Write-Host -f darkyellow \"Please restart your command shell for these changes to take effect\""
        ]
    },    
    "depends": [
        "openssh"
    ],
    "provides": [
        "rsync"
    ],
    "checkver": {
        "url": "http://repo.msys2.org/msys/x86_64/",
        "re": "\"rsync-([\\d.-]+)-x86_64\\.pkg\\.tar\\.xz\"",
        "reverse": true
    },
    "autoupdate": {
        "architecture": {
            "64bit": {
                "url": "http://repo.msys2.org/msys/x86_64/rsync-3.1.3-1-x86_64.pkg.tar.xz"
            },
            "32bit": {
                "url": "http://repo.msys2.org/msys/i686/rsync-3.1.3-1-i686.pkg.tar.xz"
            }
        }
    }
}
